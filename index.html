<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√≤ ch∆°i x·∫øp h√¨nh</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #95d2f8;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        h1 {
            margin: 20px 0;
            color: #333;
        }

        #game-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 20px;
            margin-top: 20px;
        }

        #puzzle-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            width: 300px;
            padding: 10px;
            border: 2px dashed #007ea7;
            background-color: #e0f7fa;
        }

        #grid-container {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 5px;
            padding: 10px;
            border: 2px solid #007ea7;
            background-color: #ffffff;
        }

        .puzzle-piece, .grid-cell {
            width: 100px;
            height: 100px;
            border: 2px solid #007ea7;
            background-size: cover;
            background-position: center;
            cursor: grab;
        }

        .grid-cell {
            background-color: #f0f0f0;
        }

        #start-game {
            background-color: #007ea7;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 20px 0;
        }

        #start-game:hover {
            background-color: #005f73;
        }

        .slider-container {
            margin-top: 150px;
            position: relative;
            width: 100%;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .slider-track {
            display: flex;
            animation: scroll 30s linear infinite;
        }
        
        .slider-text {
            font-size: 100px;
            font-weight: bold;
            color: #007ea7;
            margin: 100px 50px;
            white-space: nowrap;
            display: inline-block;
        }
        
        @keyframes scroll {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-100%);
            }
        }     

        .video-container {
            position: relative;
            text-align: center;
            margin-top: 20px;
            height: 100%; /* Adjust height as needed */
            max-height: 300px; /* Max width for the video */
            margin-left: auto;
            margin-right: auto; /* Center the video */
        }
        
        video {
            height: 100%;  /* Makes the video fill the container */
            object-fit: cover;  /* Ensures the video covers the area without stretching */
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        

        .falling-icons {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }

        .icon {
            position: absolute;
            width: 40px;
            height: 40px;
            animation: fall linear infinite;
            z-index: 10;
        }

        @keyframes fall {
            0% {
                transform: translateY(-100%);
            }
            100% {
                transform: translateY(100vh);
            }
        }
    </style>
</head>
<body>
    <div id="step1">
    <h1>M√¨nh s·∫Ω ch∆°i m·ªôt tr√≤ ch∆°i nh·ªè 1 m·∫°ng ƒë·ªÉ b·∫Øt ƒë·∫ßu nhe~</h1>
    <button id="start-game">B·∫Øt ƒë·∫ßu</button>
    <div id="game-container">
        <!-- Khu v·ª±c m·∫£nh gh√©p -->
        <div id="puzzle-container"></div>
        <!-- Khung ƒë·ªÉ x·∫øp h√¨nh -->
        <div id="grid-container"></div>
    </div>

    <script>
        const pieces = [
            { id: 1, src: 'img1.jpg', position: { row: 0, col: 0 } },
            { id: 2, src: 'img2.jpg', position: { row: 0, col: 1 } },
            { id: 3, src: 'img3.jpg', position: { row: 0, col: 2 } },
            { id: 4, src: 'img4.jpg', position: { row: 1, col: 0 } },
            { id: 5, src: 'img5.jpg', position: { row: 1, col: 1 } },
            { id: 6, src: 'img6.jpg', position: { row: 1, col: 2 } },
            { id: 7, src: 'img7.jpg', position: { row: 2, col: 0 } },
            { id: 8, src: 'img8.jpg', position: { row: 2, col: 1 } },
            { id: 9, src: 'img9.jpg', position: { row: 2, col: 2 } }
        ];

        const puzzleContainer = document.getElementById('puzzle-container');
        const gridContainer = document.getElementById('grid-container');
        const startGameButton = document.getElementById('start-game');
        let draggedPiece = null;

        // H√†m x√°o tr·ªôn m·∫£nh gh√©p
        function shufflePieces(pieces) {
            return pieces.sort(() => Math.random() - 0.5);
        }

        // Kh·ªüi t·∫°o c√°c m·∫£nh gh√©p ban ƒë·∫ßu
        function createPuzzlePieces() {
            puzzleContainer.innerHTML = ''; // X√≥a c√°c m·∫£nh gh√©p c≈©
            const shuffledPieces = shufflePieces([...pieces]); // Sao ch√©p m·∫£ng v√† x√°o tr·ªôn
            shuffledPieces.forEach(piece => {
                const pieceElement = document.createElement('div');
                pieceElement.classList.add('puzzle-piece');
                pieceElement.style.backgroundImage = `url(${piece.src})`;
                pieceElement.setAttribute('data-id', piece.id);
                pieceElement.setAttribute('draggable', true);
                pieceElement.addEventListener('dragstart', dragStart);
                puzzleContainer.appendChild(pieceElement);
            });
        }

        // Kh·ªüi t·∫°o khung h√¨nh vu√¥ng
        function createGrid() {
            gridContainer.innerHTML = ''; // X√≥a khung c≈©
            for (let i = 0; i < 9; i++) {
                const cellElement = document.createElement('div');
                cellElement.classList.add('grid-cell');
                cellElement.setAttribute('data-id', i + 1);
                cellElement.addEventListener('dragover', dragOver);
                cellElement.addEventListener('drop', dropPiece);
                gridContainer.appendChild(cellElement);
            }
        }

        // K√©o m·∫£nh gh√©p
        function dragStart(e) {
            draggedPiece = e.target;
            e.dataTransfer.setData('text/plain', draggedPiece.getAttribute('data-id'));
        }

        // K√©o qua √¥
        function dragOver(e) {
            e.preventDefault();
        }

        // Th·∫£ m·∫£nh gh√©p
        function dropPiece(e) {
            e.preventDefault();
            const targetCell = e.target;

            // ƒê·∫£m b·∫£o √¥ tr·ªëng
            if (targetCell.classList.contains('grid-cell') && !targetCell.style.backgroundImage) {
                targetCell.style.backgroundImage = draggedPiece.style.backgroundImage;
                draggedPiece.remove(); // X√≥a m·∫£nh gh√©p kh·ªèi khu v·ª±c ban ƒë·∫ßu

                // Ki·ªÉm tra ho√†n th√†nh
                checkCompletion();
            }
        }

        // Ki·ªÉm tra tr√≤ ch∆°i ho√†n th√†nh
        function checkCompletion() {
            const cells = document.querySelectorAll('.grid-cell');
            let completed = true;
            cells.forEach((cell, index) => {
                const correctPiece = pieces.find(piece => piece.id === parseInt(cell.getAttribute('data-id')));
                if (!cell.style.backgroundImage.includes(correctPiece.src)) {
                    completed = false;
                }
            });

            if (completed) {
                document.getElementById('step2').style.display = 'block';
                document.getElementById('step1').style.display = 'none';      
                document.getElementById('music').play();       
                generateFallingIcons();
            }
        }

        // B·∫Øt ƒë·∫ßu tr√≤ ch∆°i
        startGameButton.addEventListener('click', () => {
            startGameButton.style.display = 'none'; // ·∫®n n√∫t b·∫Øt ƒë·∫ßu
            createPuzzlePieces();
            createGrid();
        });
    </script>
</div>

<div id="step2" style="display:none;">
    <div class="slider-container">
        <audio id="music" src="hb.mp3"></audio>
        <div class="slider-track">
            <!-- D√≤ng ch·ªØ ch·∫°y -->
            <div class="slider-text">HAPPY BIRTHDAY NM H√ôNG</div>
            <div class="slider-text">HAPPY BIRTHDAY NM H√ôNG</div>
            <!-- Nh√¢n ƒë√¥i d√≤ng ch·ªØ ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng li√™n t·ª•c -->
            <div class="slider-text">HAPPY BIRTHDAY NM H√ôNG</div>
            <div class="slider-text">HAPPY BIRTHDAY NM H√ôNG</div>
        </div>
    </div>
    <div class="falling-icons" id="icons"></div>
</div>


<div id="step3" style="display: none">
    <div class="video-container">
        <video id="result-video" controls>
            <source src="video.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
</div>

<script>

    // L·∫•y ph·∫ßn t·ª≠ audio v√† slider
const backgroundMusic = document.getElementById('music');
const sliderContainer = document.querySelector('.slider-container');
const videoContainer = document.querySelector('.video-container');
const iconsContainer = document.getElementById('icons');

// Khi nh·∫°c k·∫øt th√∫c, ·∫©n step2 v√† hi·ªÉn th·ªã step3
backgroundMusic.addEventListener('ended', () => {
    document.getElementById('step2').style.display = 'none'; // ·∫®n step2
    document.getElementById('step3').style.display = 'block'; // Hi·ªÉn th·ªã step3

    // Ph√°t video sau khi nh·∫°c k·∫øt th√∫c
    const resultVideo = document.getElementById('result-video');
    resultVideo.play().catch(error => {
        console.log('Video kh√¥ng th·ªÉ ph√°t:', error);
    });
});
    // T·∫°o c√°c icon r∆°i t·ª´ tr√™n xu·ªëng
    function generateFallingIcons() {
        const iconTypes = ['üéâ', 'üéÇ', '‚≠ê', '‚ù§Ô∏è', 'üéµ']; // Bi·ªÉu t∆∞·ª£ng tu·ª≥ ch·ªçn
        const numIcons = 5;

        for (let i = 0; i < numIcons; i++) {
            const icon = document.createElement('div');
            icon.classList.add('icon');
            icon.textContent = iconTypes[Math.floor(Math.random() * iconTypes.length)];
            icon.style.left = `${Math.random() * 100}vw`;
            icon.style.animationDuration = `${Math.random() * 22 + 2}s`;
            iconsContainer.appendChild(icon);

            // Xo√° icon sau khi ho√†n th√†nh animation
            icon.addEventListener('animationend', () => {
                icon.remove();
            });
        }

        // L·∫∑p l·∫°i vi·ªác t·∫°o icon sau m·ªói kho·∫£ng th·ªùi gian
        setInterval(() => {
            generateFallingIcons();
        }, 20000);
    }
</script>
</body>
</html>
